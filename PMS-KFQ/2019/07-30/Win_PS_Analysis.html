<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="/Scripts/boot.js?v=$AppVersion" type="text/javascript"></script>
    <script src="/Scripts/plugins/echarts/source/echarts.js" type="text/javascript"></script>
    <script src="/Scripts/PlatForm/ComTools.js?version=$AppVersion" type="text/javascript"></script>
    <script src="/Form/Init/$Model.data.FormId/$Model.data.FormState/$Model.data.KeyValue"></script>
    <style>
        *::-webkit-scrollbar {
            width: 8px;
            background-color: #fff;
        }

        *::-webkit-scrollbar-thumb {
            background-color: #ddd;
            border-radius: 8px;
            -webkit-box-shadow: inset 0 0 6px rgba(255, 255, 255, .3);
        }

        .dashboard-stat .visual {
            float: right;
            text-align: right;
            /* padding-right: 15px; */
        }

        .row-hd-responsive .portlet.box.blue {
            border: 1px solid transparent;
        }

        .dashboard-stat {
            padding: 0 20px 20px 20px;
        }

        .dashboard-stat .more {
            opacity: 1;
        }

        .dashboard-stat .more span {
            font-size: 13px;
        }

        .dashboard-stat .details {
            width: 95%;
            left: 10px;
            color: #fff;
            right: unset;
            padding-left: 10px;
            padding-right: 20px;
        }

        .dashboard-stat .details .project-number {
            padding: 5px 0;
            margin-left: 5px;
        }

        .dashboard-stat .details .number {
            text-align: left;
        }

        .more-right {
            display: inline-block;
            float: right;
        }

        .dashboard-stat .visual i {
            font-size: 30px;
        }

        .dashboard-stat .visual i {
            margin-left: 7px;
        }

        .dashboard-stat.blue {
            background-color: #62b2e6;
        }

        .dashboard-stat.blue:hover {
            background-color: #74c0f1;
        }

        .dashboard-stat {
            margin-bottom: 5px;
            height: 120px;
            cursor: pointer;
        }

        .dashboard-stat.purple {
            background-color: #8083d8;
        }

        .dashboard-stat.purple:hover {
            background-color: #9a9dea;
        }

        .dashboard-stat.yellow {
            background-color: #ffd076;
        }

        .dashboard-stat.yellow:hover {
            background-color: #fad691;
        }

        .dashboard-stat.red {
            background-color: #F96A58;
        }

        .dashboard-stat.green {
            background-color: #56cda7;
        }

        .dashboard-stat.green:hover {
            background-color: #5eddb4;
        }

        .dashboard-stat .visual {
            height: 100%;
            margin: 0;
        }

        .dashboard-stat .details .number {
            font-size: 25px;
            font-weight: 500;
            margin-bottom: unset;
        }

        .dashboard-stat .visual {
            padding-top: 15px;
        }

        .time {
            display: inline-block;
            float: right;
        }


        .dashboard-stat .visual img {
            width: 40px;
            height: 40px;
        }

        .dashboard-stat .more {
            padding: 0 0 5px 0;
        }

        .dashboard-stat .details .project-name {
            font-size: 16px;
            margin-left: 5px;
        }

        .header-left-title {
            font-size: 16px;
        }

        .btn-info {
            color: #fff;
            background-color: #5bc0de !important;
            border-color: #46b8da;
            border-radius: 3px;
        }

        .btn-info:hover,
        .btn-info:focus,
        .btn-info:active,
        .btn-info.active {
            color: #fff;
            background-color: #39b3d7 !important;
            border-color: #269abc;
        }

        .moreBtn {
            padding-right: 5px;
        }

        .portlet.box>.portlet-title,
        .portlet.box>.portlet-title .caption {
            height: 35px;
            line-height: 35px;
        }

        .tab-brief>.tab-title .this {
            color: #4BCEA9;
        }

        .portlet.box>.portlet-body {
            padding: 5px 0;
        }

        .tab-title li:first-child {
            padding-right: 8px;
        }

        .tab-title li {
            position: relative;
            line-height: 28px;
            height: 30px;
            font-size: 16px;
            color: #666;
            text-align: center;
            cursor: pointer;
            display: inline-block;
            *display: inline;
            *zoom: 1;
            vertical-align: middle;
            transition: all .2s;
            -webkit-transition: all .2s;
        }

        .tab-item {
            display: none;
            height: 100%;
            width: 100%;
        }

        .latest-additions {
            padding: 0 10px;
            height: 100%;
            overflow: hidden;
        }

        .latest-additions ul li {
            height: 30px;
            line-height: 30px;
            padding-bottom: 35px;
            border-bottom: 1px solid #ddd;
        }

        .name {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 70%;
            display: inline-block;
        }

        .cargo_icon {
            padding-right: 5px;
        }

        .chartBox {
            float: left;
            width: 33%;
        }

        .item-survey-box {
            height: 100%;
            width: 100%;
            padding: 0 10px;
        }

        .item-survey {
            width: 50%;
            float: left;
        }

        .portlet-title .moreBox {
            color: #444;

        }

        .item-survey-left ul li {
            line-height: 40px;
            height: 40px;

        }

        .button-box {
            position: absolute;
            z-index: 999;
            cursor: pointer;
            right: 0;
            padding-top: 10px;
        }

        .button-box ul li {
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 1px 6px;
            float: left;
            margin-right: 5px;
        }

        .button-box ul li.active {
            border: 1px solid #75B2FF;
            background: #75B2FF;
            color: #fff;
        }
    </style>

</head>

<body style="margin: 0; padding: 0; overflow-x: hidden;">
    <div class="row  row-hd row-hd-responsive" style="height: 100%">

        <div class="row">
            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <a href="/Form/EditForm/de4ad5cc-9fa3-406a-bb92-47828922686c/">
                    <div class="dashboard-stat green">
                        <div class="visual">
                            <img src="/PowerPlat/FormXml/zh-CN/StdPortalManage/image/iconimg1.png" alt="">
                        </div>
                        <div class="details">
                            <!-- <div class="number">
                                <span id="YearTotalInvest">0</span>
                            </div>
                            <div class="project-name">
                                年度签约合同
                            </div> -->
                            <div class="project-number">
                                <br/>
                                <span>年度签约合同</span>
                                <span id="a1"></span>个
                                <br/>
                                <span>金额</span>
                                <span id="a2"></span>
                                <br/>
                                <span>季度签约数</span>
                                <span id="a3"></span>个，
                                <span>金额</span>
                                <span id="a4"></span>
                                <br/>
                                <span>月度签约数</span>
                                <span id="a5"></span>个，
                                <span>金额</span>
                                <span id="a6"></span>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <a href="/Form/EditForm/d3cdc5cc-752f-4916-b18b-9e83a0824b48/">
                    <div class="dashboard-stat blue">
                        <div class="visual">
                            <img src="/PowerPlat/FormXml/zh-CN/StdPortalManage/image/iconimg2.png" alt="">
                        </div>
                        <div class="details">
                            <!-- <div class="number">
                                <span id="TotalPreTask">0</span>个
                            </div>
                            <div class="project-name">
                                前期批文
                            </div> -->
                            <div class="project-number">
                                <br/>
                                <span>年度拟付金额</span>
                                <span id="b1"></span>
                                <br/>
                                <span>季度拟付金额</span>
                                <span id="b2"></span>
                                <br/>
                                <span>月度拟付金额</span>
                                <span id="b3"></span>
                                <br/>
                            </div>
                        </div>

                    </div>
                </a>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <a href="/Form/EditForm/bf98ef25-4fc0-495c-9a31-de14f1c1e2fc/">
                    <div class="dashboard-stat purple">
                        <div class="visual">
                            <img src="/PowerPlat/FormXml/zh-CN/StdPortalManage/image/iconimg3.png" alt="">
                        </div>
                        <div class="details">
                            <!-- <div class="number">
                                <span id="ContractAmount">0</span>万元
                            </div>
                            <div class="project-name">
                                在执行合同情况
                            </div> -->
                            <div class="project-number">
                                <br/>
                                <span>年度支付金额</span>
                                <span id="c1"></span>
                                <br/>
                                <span>季度支付金额</span>
                                <span id="c2"></span>
                                <br/>
                                <span>月度支付金额</span>
                                <span id="c3"></span>
                            </div>
                        </div>

                    </div>
                </a>
            </div>
            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                <a href="/Form/EditForm/5303781a-18b9-4307-a1be-35f0b7d9f83d/">
                    <div class="dashboard-stat yellow">
                        <div class="visual">
                            <img src="/PowerPlat/FormXml/zh-CN/StdPortalManage/image/iconimg4.png" alt="">
                        </div>
                        <div class="details">
                            <!-- <div class="number">
                                <span id="MileNum"></span>个
                            </div>
                            <div class="project-name">
                                进度情况
                            </div> -->
                            <div class="project-number">
                                <br/>
                                <span>年度变更金额</span>
                                <span id="d1"></span>
                                <br/>
                                <span>季度变更金额</span>
                                <span id="d2"></span>
                                <br/>
                                <span>月度变更金额</span>
                                <span id="d3"></span>
                            </div>
                        </div>

                    </div>
                </a>
            </div>
        </div>
        <div class="col-lg-8 col-md-8" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:335px;overflow: hidden;">
                    <div id="tabs1" class="tab tab-brief" style="width:100%;height:100%;" lay-filter="docDemoTabBrief">
                        <div class="portlet-title">
                            <div class="caption">
                                <span class="header-left-title">列表</span>
                                <span style="display:block; float:right; text-align:right;">
                                    <a class="moreBox" href="/Form/EditForm/aaf92990-a3b5-4ba5-b051-c30e85608129/">更多</a>
                                </span>
                            </div>
                        </div>
                        <div class="tab-content" style="height:calc(100% - 35px);width:100%;">
                            <div class="tab-item">
                                <div id="container" style="height:100%;width:100%;">
                                </div>
                            </div>
                            <div class="tab-item show">
                                <div class="mini-datagrid" style="height:500px;width:100%;" idfield="Id" allowresize="true" onrowdblclick="ProjectClick(this)" allowcelledit="true" id="PS_PreMProject" allowcellselect="true">
                                    <div property="columns">
                                        <div type="indexcolumn" width="30" headeralign="center">序号</div>
                                        <div field="ProjCode" name="ProjCode" headeralign="center" width="100" align="center">项目编号</div>
                                        <div field="ProjName" name="ProjName" headeralign="center" width="180" align="center">项目名称</div>
                                        <div field="PlanStartTime" headeralign="center" name="PlanStartTime" allowsort="true" align="center" width="90" header="计划开工时间" dateformat="yyyy-MM-dd" align="left">
                                             计划开工时间
                                        </div>
                                        <div field="PlanFinishedTime" headeralign="center" name="PlanFinishedTime" align="center" allowsort="true" width="90" header="计划完工时间" dateformat="yyyy-MM-dd" align="left">
                                             计划完工时间
                                        </div>
                                        <div field="TotalInvestment" name="TotalInvestment" numberformat="n2" headeralign="center" width="90" align="center" header="总投资（万元）">
                                             总投资（万元）
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-4" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-title">
                    <div class="caption">
                        <span class="header-left-title">项目动态</span>
                    </div>
                    <div class="tools">
                        <a class="moreBox" href="/PowerPlat/FormXml/zh-CN/StdPortalManage/project_center.html?_projCode=''&_projName=''">更多</a>
                    </div>
                </div>
                <div class="portlet-body" style="height:300px;width:100%;">
                    <div class="latest-additions ">
                        <ul id="ProjDynamics">
                            
                        </ul>
                    </div>

                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;padding:20px;">
                    <div id="chart1" style="width:100%;height:100%;"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;padding:20px;position: relative;">
                    <div id="tabList" class="button-box">
                        <ul>
                            <li class="active">数量</li>
                            <li>金额</li>
                        </ul>
                    </div>
                    <div id="chart2" style="width:100%;height:100%;">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;padding:20px;">
                    <div id="chart3" style="width:100%;height:100%;"></div>

                </div>
            </div>
        </div>
        <div class="col-lg-12 col-md-12" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;">
                    <div id="chart4" style="width:100%;height:100%;">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;padding:10px;position: relative;">
                    <div id="chart5" style="width:100%;height:100%;">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-8 col-md-8" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;padding:10px;">
                    <div id="chart6" style="width:100%;height:100%;">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-8 col-md-8" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;">
                    <div id="chart7" style="width:100%;height:100%;">

                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-4" style="padding-top:10px;">
            <div class="portlet box blue portlet-title-left-box">
                <div class="portlet-body" style="width:100%;height:300px;">
                    <div id="chart8" style="width:100%;height:100%;">

                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<!--<script src="https://webapi.amap.com/maps?v=1.4.10&key=4f3a329fb8986b6b826d4c421f085665"></script>-->

<script>
        mini.parse()
       //获取完整的日期
       var date = new Date;
       var year = date.getFullYear();
       
       var option1 = {
           title: {
               text: '投资完成率',
               x: 'center',
               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },

           calculable: true,

           tooltip: {
               formatter: "{c}"
           },
           series: [
               {
                   name: '投资完成率',
                   type: 'gauge',
                   min: 0,
                   max: 100,
                   radius: '80%',
                   // splitNumber: 10,
                   center: ['50%', '60%'],
                   axisLine: {            // 坐标轴线
                       lineStyle: {       // 属性lineStyle控制线条样式
                           color: [[0.2, '#F56C6F'], [0.8, '#56CDA7'], [1, '#5B7ADC']],
                           width: 20
                       }
                   },
                   axisTick: {            // 坐标轴小标记
                       length: 5,        // 属性length控制线长
                       lineStyle: {       // 属性lineStyle控制线条样式
                           color: '#fff'
                       }
                   },
                   pointer: {
                       width: 5
                   },
                   splitLine: {           // 分隔线
                       length: 20,         // 属性length控制线长
                       lineStyle: {       // 属性lineStyle（详见lineStyle）控制线条样式
                           color: '#fff'
                       }
                   },
                   detail: {
                       textStyle: {       // 其余属性默认使用全局文本样式，详见TEXTSTYLE
                           // fontWeight: 'bolder'
                       }
                   },
                   data: []
               }
           ]
       }
       var option2 = {
           color: [],

           title: {
               text: '投资分布',
               x: 'center',
               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },
           tooltip: {
               trigger: 'item',
               formatter: "{a} <br/>{b} : {c}"
           },
           calculable: false,
           series: [
               {
                   name: '投资分布',
                   type: 'pie',
                   radius: '55%',
                   center: ['50%', '60%'],
                   data: [
                   ],
                   itemStyle: {
                       normal: {
                           label: {
                               show: true,
                               formatter: '{b} \n{d}%'
                           },
                           labelLine: { show: true }
                       }
                   }
               }
           ]
       };
       var option3 = {
           title: {
               text: '问题解决率',
               x: 'center',
               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },

           calculable: true,

           tooltip: {
               formatter: "{c}"
           },
           series: [
               {
                   name: '问题解决率',
                   type: 'gauge',
                   min: 0,
                   max: 100,
                   radius: '80%',
                   // splitNumber: 10,
                   center: ['50%', '60%'],
                   axisLine: {            // 坐标轴线
                       lineStyle: {       // 属性lineStyle控制线条样式
                           color: [[0.2, '#F56C6F'], [0.8, '#56CDA7'], [1, '#5B7ADC']],
                           width: 20
                       }
                   },
                   axisTick: {            // 坐标轴小标记
                       length: 5,        // 属性length控制线长
                       lineStyle: {       // 属性lineStyle控制线条样式
                           color: '#fff'
                       }
                   },
                   pointer: {
                       width: 5
                   },
                   splitLine: {           // 分隔线
                       length: 20,         // 属性length控制线长
                       lineStyle: {       // 属性lineStyle（详见lineStyle）控制线条样式
                           color: '#fff'
                       }
                   },
                   detail: {
                       textStyle: {       // 其余属性默认使用全局文本样式，详见TEXTSTYLE
                           // fontWeight: 'bolder'
                       }
                   },
                   data: []
               }
           ]


       };
       var option4 = {
           title: {
               text: '投资完成统计',

               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },
           grid: {
               borderWidth: 0,
               x: 40,
               x2: 10,
               y: 50,
               y2: 30
           },

           tooltip: {
               trigger: 'axis',
               axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                   type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
               },
           },
           legend: {
               padding: 20,
               data: ['计划值', '修正值', "实际值"]
           },

           calculable: true,
           xAxis: [
               {
                   splitLine: { show: false },//去除网格线
                   type: 'category',
                   axisLine: {
                       lineStyle: {
                           color: '#666',
                           width: 1,//这里是为了突出显示加上的
                       }
                   },
                   data: ['2018-01', '2018-02', '2018-03', '2018-04', '2018-05', '2018-06', '2018-07', '2018-08', '2018-09']
               }
           ],
           yAxis: [
               {
                   type: 'value',
                   axisLine: {
                       lineStyle: {
                           color: '#666',
                           width: 1,//这里是为了突出显示加上的
                       }
                   },
               }
           ],
           series: [
               {
                   name: '计划值',
                   type: 'bar',
                   barMaxWidth: 15,//柱子最大宽度
                   itemStyle: {
                       normal: {
                           color: '#fec400'

                       }
                   },
                   barCategoryGap: '50%',

                   data: [1250, 1500, 1000, 1900, 1200, 900, 1200, 1200, 2300, 1500, 800, 1600],

               },
               {
                   name: '修正值',
                   type: 'bar',
                   barMaxWidth: 15,//柱子最大宽度
                   itemStyle: {
                       normal: {
                           color: '#63cda7'

                       }
                   },
                   barCategoryGap: '50%',

                   data: [800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800, 800],

               },
               {
                   name: '实际值',
                   type: 'line',
                   itemStyle: {
                       normal: {
                           color: '#63cda7'

                       }
                   },
                   data: [800, 1000, 1200, 1300, 1500, 1700, 1900, 2000, 2000, 2000, 2000, 2500],

               }
           ]
       };
       var option5 = {
           color: ['#FFCB68', '#63CDA7', '#62B2E6'],

           title: {
               text: '质量问题状态',
               x: 'center',
               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },
           tooltip: {
               trigger: 'item',
               formatter: "{a} <br/>{b} : {c}"
           },
           calculable: false,
           series: [
               {
                   name: '质量问题状态',
                   type: 'pie',
                   radius: '55%',
                   center: ['50%', '60%'],
                   data: [],
                   itemStyle: {
                       normal: {
                           label: {
                               show: true,
                               formatter: '{b} \n {d}%'
                           },
                           labelLine: { show: true }
                       }
                   }
               }
           ]
       };
       var option6 = {
           title: {
               text: '各月质量问题',

               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },
           grid: {
               borderWidth: 0,
               x: 40,
               x2: 10,
               y: 50,
               y2: 30
           },

           tooltip: {
               trigger: 'axis',
               axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                   type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
               },
           },
           legend: {
               padding: 20,
               data: ['问题总数', '已解决个数']
           },

           calculable: true,
           xAxis: [
               {
                   splitLine: { show: false },//去除网格线
                   type: 'category',
                   axisLine: {
                       lineStyle: {
                           color: '#666',
                           width: 1,//这里是为了突出显示加上的
                       }
                   },
                   data: []
               }
           ],
           yAxis: [
               {
                   type: 'value',
                   axisLine: {
                       lineStyle: {
                           color: '#666',
                           width: 1,//这里是为了突出显示加上的
                       }
                   },
               }
           ],
           series: [
               {
                   name: '问题总数',
                   type: 'bar',
                   barMaxWidth: 20,//柱子最大宽度
                   itemStyle: {
                       normal: {
                           color: '#62B2E6'

                       }
                   },
                   barCategoryGap: '50%',

                   data: [],

               },
               {
                   name: '已解决个数',
                   type: 'bar',
                   barMaxWidth: 20,//柱子最大宽度
                   itemStyle: {
                       normal: {
                           color: '#fec400'

                       }
                   },
                   barCategoryGap: '50%',

                   data: [],
               }
           ]
       };
       var option7 = {
           title: {
               text: '危险源个数',

               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },
           grid: {
               borderWidth: 0,
               x: 40,
               x2: 40,
               y: 50,
               y2: 30
           },
           tooltip: {
               trigger: 'axis',
               axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                   type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
               },
               formatter: function (params) {
                   return params[0].name + '<br/>'
                       + params[0].seriesName + ' : ' + params[0].value;
               }
           },
           legend: {
               selectedMode: false,
               padding: 20,
               data: ['数量']
           },

           calculable: true,
           xAxis: [
               {
                   type: 'category',
                   axisLine: {
                       lineStyle: {
                           color: '#666',
                           width: 1,//这里是为了突出显示加上的
                       }
                   },
                   data: []
               }
           ],
           yAxis: [
               {
                   type: 'value',
                   axisLine: {
                       lineStyle: {
                           color: '#666',
                           width: 1,//这里是为了突出显示加上的
                       }
                   },
                   boundaryGap: [0, 0.1]
               }
           ],
           series: [
               {
                   name: '数量',
                   type: 'bar',
                   stack: 'sum',
                   barMaxWidth: 30,//柱子最大宽度
                   barCategoryGap: '50%',
                   itemStyle: {
                       normal: {
                           color: '#63CDA7',
                           barBorderColor: '#63CDA7',
                           barBorderWidth: 6,
                           barBorderRadius: 0,
                           label: {
                               show: true, position: 'insideTop'
                           }
                       }
                   },
                   data: []
               }
           ]
       };
       var option8 = {
           title: {
               text: '危险源类型',
               x: 'center',
               textStyle: {
                   //文字颜色
                   color: '#595978',
                   //字体风格,'normal','italic','oblique'
                   fontStyle: 'normal',
                   //字体粗细 'normal','bold','bolder','lighter',100 | 200 | 300 | 400...
                   fontWeight: '500',
                   //字体系列
                   fontFamily: 'sans-serif',
                   //字体大小
                   fontSize: 16
               }
           },
           tooltip: {
               trigger: 'item',
               formatter: "{a} <br/>{b} : {c} ({d}%)"
           },
           color: ['#63CDA7', '#F2CD86', '#EC7D6E'],
           series: [
               {
                   type: 'pie',
                   radius: ['50%', '65%'],
                   itemStyle: {
                       normal: {
                           label: {
                               show: false
                           },
                           labelLine: {
                               show: false
                           }
                       },

                       emphasis: {
                           label: {
                               show: true,
                               position: 'center',
                               textStyle: {
                                   fontSize: '16',
                                   fontWeight: 'bold'
                               },
                                   labelLine: {
                                       show: false
                                   }
                           }
                       }
                   },
                   data: []
               }
           ]
       };
       //Al add 2019年7月30日 13:53:45
       $.ajax({
                url: "/ALLZ/GetAnalysis",
                data: {},
                type: "POST",
                success: function (text) {
                    var o = mini.decode(text);
                    if (o.success) {
                        var data = o.data;
                        $("#a1").append(data.a1);
                        $("#a2").append(data.a2);
                        $("#a3").append(data.a3);
                        $("#a4").append(data.a4);
                        $("#a5").append(data.a5);
                        $("#a6").append(data.a6);

                        $("#b1").append(data.b1);
                        $("#b2").append(data.b2);
                        $("#b3").append(data.b3);

                        $("#c1").append(data.c1);
                        $("#c2").append(data.c2);
                        $("#c3").append(data.c3);

                        $("#d1").append(data.d1);
                        $("#d2").append(data.d2);
                        $("#d3").append(data.d3);
                    }
                }
       });

       //判断数据库类型
       var dbType = "sql";
       $.ajax({
           url: "/API/GetDBType",
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               var tmp = mini.decode(text);
               if (tmp.success) {
                   dbType = tmp.data.value;
               }
               else {
                   Power.ui.error(tmp.message);
                   e.cancel = true;
                   return;
               }
           }
       })

       var LongCode = sessiondata.EpsProjLongCode;
       var jsonData = [];
       var one = {};
       one.KeyWord = "V_ProjCenter_TotalInvest"; //数据集的名字
       one.Type = "ViewEntity"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = "a.PlanTypeName='InvestPlan' and  a.EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')";
       jsonData.push(one); //组装
       one = {};
       one.KeyWord = "V_ProjCenter_ProjCount"; //数据集的名字
       one.Type = "ViewEntity"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')";
       jsonData.push(one); //组装
       one = {};
       one.KeyWord = "PS_PreM_PreTasks"; //数据集的名字
       one.Type = "Business"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = ""
       jsonData.push(one); //组装
       //执行合同情况
       one = {};
       one.KeyWord = "V_ProjCenter_ContractAmount"; //数据集的名字
       one.Type = "ViewEntity"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')";
       jsonData.push(one); //组装
       one = {};
       one.KeyWord = "V_ProjCenter_PaymentAmount"; //数据集的名字
       one.Type = "ViewEntity"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')";
       jsonData.push(one); //组装
       //投资完成情况
       one = {};
       one.KeyWord = "V_ProjCenter_InvestPlanSummary"; //数据集的名字
       one.Type = "ViewEntity"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = "c.EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "') and a.InvestYear=" + year;
       jsonData.push(one); //组装
       one = {};
       one.KeyWord = "V_ProjCenter_InvestActSummary"; //数据集的名字
       one.Type = "ViewEntity"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       one.Where = "C.EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "') and a.InvestYear=" + year;
       jsonData.push(one); //组装
       one = {};
       one.KeyWord = "PS_ProjInfo"; //数据集的名字
       one.Type = "Business"; //类型 枚举型 ViewEntity 数据集  Business 业务对象
       jsonData.push(one); //组装
    //    //Al add 2019年7月30日 12:33:35
    //    one = {};
    //    one.KeyWord = "KFQ_ContractSc"; //a1
    //    one.Type = "Business"; 
    //    one.Where = " status = 50";
    //    jsonData.push(one); //组装
       getDataJson(jsonData, function (data) {
        //    //a1
        //    if (data.data["KFQ_ContractSc"] && data.data["KFQ_ContractSc"].length > 0) {
        //         var suma1 = 0;
        //         for (var i = 0; i < data.data.KFQ_ContractSc.length; i++) {
        //             suma1 += data.data.KFQ_ContractSc[i].ContractAmount;
        //         }
        //         $("#a1").html(data.data.KFQ_ContractSc.length);
        //         $("#a2").html(suma1);
        //     }
        //    //项目总投资
        //    if (data.data["V_ProjCenter_TotalInvest"] && data.data["V_ProjCenter_TotalInvest"].length > 0) {
        //        $("#YearTotalInvest").html(data.data.V_ProjCenter_TotalInvest[0].Total.toFixed(2));
        //    }
        //    //项目总数
        //    if (data.data["V_ProjCenter_ProjCount"] && data.data["V_ProjCenter_ProjCount"].length > 0) {
        //        var sumProj = 0;
        //        for (var i = 0; i < data.data.V_ProjCenter_ProjCount.length; i++) {
        //            sumProj += data.data.V_ProjCenter_ProjCount[i].Count;
        //            if (data.data.V_ProjCenter_ProjCount[i].Status == "50") {
        //                $("#ProjApprCount").html(data.data.V_ProjCenter_ProjCount[i].Count);
        //            }
        //        }
        //        $("#TotalProjectCount").html(sumProj);
        //    }
        //    //前期批文
        //    if (data.data["PS_PreM_PreTasks"] && data.data["PS_PreM_PreTasks"].length > 0) {
        //        var sumProj = data.data.PS_PreM_PreTasks.length;
        //        var PreTaskApprCount = 0;
        //        for (var i = 0; i < data.data.PS_PreM_PreTasks.length; i++) {
        //            if ((data.data.PS_PreM_PreTasks[i].Status == "50" || data.data.PS_PreM_PreTasks[i].Status == "35") && mini.formatDate(data.data.PS_PreM_PreTasks[i].ActEndTime, 'yyyy-MM-dd') != "1901-01-01") {
        //                PreTaskApprCount += 1;
        //            }
        //        }
        //        $("#TotalPreTask").html(sumProj);
        //        $("#PreTaskApprCount").html(PreTaskApprCount);
        //    }
        //    if (data.data["V_ProjCenter_ContractAmount"] && data.data["V_ProjCenter_ContractAmount"].length > 0) {
        //        data.data["V_ProjCenter_ContractAmount"][0].TotalContractAmount = Math.round(data.data["V_ProjCenter_ContractAmount"][0].TotalContractAmount);
        //        $("#ContractAmount").html(Math.round(data.data["V_ProjCenter_ContractAmount"][0].TotalContractAmount / 10000).toFixed(2));
        //        if (data.data["V_ProjCenter_PaymentAmount"] && data.data["V_ProjCenter_PaymentAmount"].length > 0) {
        //            var diff = data.data["V_ProjCenter_ContractAmount"][0].TotalContractAmount - data.data["V_ProjCenter_PaymentAmount"][0].PaymentAmount;
        //            $("#PaymentAmount").html(Math.round(diff / 10000).toFixed(2));
        //        }
        //    }
           //option4 投资情况
           var axisX = [];
           var planAmountArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
           var yearPlanAmountArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
           var actAmountArray = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
           var dataPlan = data.data.V_ProjCenter_InvestPlanSummary, dataAct = data.data.V_ProjCenter_InvestActSummary;
           for (var i = 0; i < 12; i++) {
               axisX.push(year + "-" + (i + 1));
               for (var x = 0; x < dataPlan.length; x++) {
                   if (dataPlan[x].Month == i) {
                       yearPlanAmountArray[i] = dataPlan[x].YearPlanAmount;
                       planAmountArray[i] = dataPlan[x].PlanAmount;
                   }
               }
               for (var y = 0; y < dataAct.length; y++) {
                   if (dataAct[y].Month == i)
                       actAmountArray[i] = dataAct[y].ActAmount;
               }
           }
           option4.xAxis[0].data = axisX;
           option4.series[0].data = yearPlanAmountArray;
           option4.series[1].data = planAmountArray;
           option4.series[2].data = actAmountArray;
           InitEChart("chart4", option4);
       });
 
       //获取进度节点详情
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_pln_project_task", KeyWordType: "ViewEntity",
               select: "project_guid,project_shortname,project_name,LongCode,target_start_date,target_end_date,MileNum,NormalNum,LagNum",
               swhere: "p.LongCode like '%" + LongCode + ".%'",
               sort: "LongCode asc",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var MileNumSum = 0;
               var NormalNumSum = 0;
               var LagNumSum = 0;
               if (data.length > 0) {
                   for (var i = 0; i < data.length; i++) {
                       MileNumSum = parseInt(MileNumSum) + parseInt(data[i].MileNum);
                       NormalNumSum = parseInt(NormalNumSum) + parseInt(data[i].NormalNum);
                       LagNumSum = parseInt(LagNumSum) + parseInt(data[i].LagNum);
                   }
               }
               $("#MileNum").html(MileNumSum);
               $("#NormalNum").html(NormalNumSum);
               $("#LagNum").html(LagNumSum);
           }
       });
       //投资完成率
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_InvestPlanActTotal", KeyWordType: "ViewEntity",
               select: "TotalPlanInvest,TotalActualInvest,EpsProjId",
               swhere: "InvestYear='" + year + "' and EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option1data = [{ value: 0 }];
               var TotalPlanInvest=0;
               var TotalActualInvest=0;
               if (data.length > 0) {
                   for (var i = 0; i < data.length; i++) {
                       TotalPlanInvest = parseFloat(TotalPlanInvest) + parseFloat(data[i].TotalPlanInvest);
                       TotalActualInvest = parseFloat(TotalActualInvest) + parseFloat(data[i].TotalActualInvest);
                   }
               }
               if (TotalPlanInvest > 0) {
                   option1data[0].value = ((TotalActualInvest / TotalPlanInvest) * 100).toFixed(2);
               }
               option1.series[0].data = option1data;
           }
       });
        
       //项目库里的数据
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "PS_PreMProject", KeyWordType: "BO",
               select: "Id,ProjCode,ProjName,PlanStartTime,PlanFinishedTime,TotalInvestment",
               swhere: "",
               sort: "ProjCode asc",
               index: "",
               size: "8"
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               
               mini.get("PS_PreMProject").setData(data);
           }
       });

       //投资分布
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_PreMProjectCategory", KeyWordType: "ViewEntity",
               select: "TypeCount,ProjectCategory,EpsProjId,TotalInvestment",
               swhere: "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option2data = [
                   { value: 0, name: '安全环保' },
                   { value: 0, name: '技术改造' },
                   { value: 0, name: '新建' },
                   { value: 0, name: '改建' },
                   { value: 0, name: '信息化' },
                   { value: 0, name: '技改' },
                   { value: 0, name: '其他' }
               ]
               for (var i = 0; i < data.length; i++) {
                   if (data[i].ProjectCategory == "安全环保") {
                       option2data[0].value = data[i].TypeCount;
                   } else if (data[i].ProjectCategory == "技术改造") {
                       option2data[1].value = data[i].TypeCount;
                   } else if (data[i].ProjectCategory == "新建") {
                       option2data[2].value = data[i].TypeCount;
                   } else if (data[i].ProjectCategory == "改建") {
                       option2data[3].value = data[i].TypeCount;
                   } else if (data[i].ProjectCategory == "信息化") {
                       option2data[4].value = data[i].TypeCount;
                   } else if (data[i].ProjectCategory == "技改") {
                       option2data[5].value = data[i].TypeCount;
                   } else if (data[i].ProjectCategory == "其他") {
                       option2data[6].value = data[i].TypeCount;
                   }
               }
               option2.series[0].data = option2data;
           }
       });

       //获取问题整改率
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_UnqualifiedNoticeCount", KeyWordType: "ViewEntity",
               select: "Id,RectifyState,EpsProjId",
               swhere: "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option3data = [{ value: 0.00 }];
               var RectifyCount = 0;
               var RectifyPassCount = 0;
               if (data.length > 0) {
                   RectifyCount = data.length;
                   for (var i = 0; i < data.length; i++) {
                       if (data[i].RectifyState == "RectifyPass") {
                           RectifyPassCount += 1;
                       }
                   }
                   option3data[0].value = ((RectifyPassCount / RectifyCount)*100).toFixed(2);
               }
               option3.series[0].data = option3data;
           }
       });
        
       //质量问题饼图
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_UnqualifiedNoticeRectifyState", KeyWordType: "ViewEntity",
               select: "RectifyStateCount,RectifyState,EpsProjId",
               swhere: "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option5data = [
                       { value: 0, name: '尚未整改' },
                       { value: 0, name: '整改中' },
                       { value: 0, name: '整改通过' },
                       { value: 0, name: '整改未通过' }
               ];
               var NotRectifyCount = 0;
               var InRectifyCount = 0;
               var RectifyPassCount = 0;
               var RectifyUnPassCount = 0;
               if (data.length > 0) {
                   RectifyCount = data.length;
                   for (var i = 0; i < data.length; i++) {
                       if (data[i].RectifyState == "NotRectify") {
                           NotRectifyCount += data[i].RectifyStateCount;
                       } else if (data[i].RectifyState == "InRectify") {
                           InRectifyCount += data[i].RectifyStateCount;
                       } else if (data[i].RectifyState == "RectifyPass") {
                           RectifyPassCount += data[i].RectifyStateCount;
                       } else if (data[i].RectifyState == "RectifyUnPass") {
                           RectifyUnPassCount += data[i].RectifyStateCount;
                       }
                   }
                   option5data[0].value = NotRectifyCount;
                   option5data[1].value = InRectifyCount;
                   option5data[2].value = RectifyPassCount;
                   option5data[3].value = RectifyUnPassCount;
               }
               option5.series[0].data = option5data;
           }
       });

       var swherevalue = "";
       if (dbType == "sql") {
           swherevalue = "year(RegDate)";
       } else if (dbType == "oracle") {
           swherevalue = "to_number(to_char(RegDate, 'yyyy'))";
       }
       var swherevalue1 = "";
       if (dbType == "sql") {
           swherevalue1 = "year(InspectionDate)";
       } else if (dbType == "oracle") {
           swherevalue1 = "to_number(to_char(InspectionDate, 'yyyy'))";
       }
       //项目动态
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_ProjectEvents1", KeyWordType: "ViewEntity",
               select: "Id,Title,RegDate,EpsProjId",
               swhere: swherevalue + "='" + year + "' and EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "0",
               size: "8"
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var html = "";
               if (data.length > 0) {
                   for (var i = 0; i < data.length; i++) {
                       html += "<li onclick=\"FormProjectEvents('" + data[i].Id + "')\"><span class='name' title=\"" + data[i].Title + "\">\"" + data[i].Title + "\"</span><span class='time'>\"" + mini.formatDate(data[i].RegDate, "yyyy-MM-dd") + "\"</span></li>";
                   }
               }
               $("#ProjDynamics").html(html.replace(/\"/g, ""));
           }
       });


       //质量问题柱状图
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_UnqualifiedNoticeInspectionDate", KeyWordType: "ViewEntity",
               select: "InspectionDate,RectifyState,EpsProjId,NoticeCount",
               swhere: swherevalue1 + "='" + year + "' and EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option6datax = [];
               for (var y = 0; y < 9; y++) {
                   option6datax.push(year + "-0" + (1 + y));
               }
               for (var y1 = 9; y1 < 12; y1++) {
                   option6datax.push(year + "-" + (1 + y1));
               }
               var option6data0 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
               var option6data1 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
               var map = {}, dest = [];
               if (data.length > 0) {
                   for (var i = 0; i < data.length; i++) {
                       if (data[i].InspectionDate == option6datax[0]) {
                           option6data0[0] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[0] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[1]) {
                           option6data0[1] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[1] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[2]) {
                           option6data0[2] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[2] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[3]) {
                           option6data0[3] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[3] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[4]) {
                           option6data0[4] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[4] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[5]) {
                           option6data0[5] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[5] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[6]) {
                           option6data0[6] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[6] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[7]) {
                           option6data0[7] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[7] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[8]) {
                           option6data0[8] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[8] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[9]) {
                           option6data0[9] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[9] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[10]) {
                           option6data0[10] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[10] += data[i].NoticeCount;
                           }
                       } else if (data[i].InspectionDate == option6datax[11]) {
                           option6data0[11] += data[i].NoticeCount;
                           if (data[i].RectifyState == "RectifyPass") {
                               option6data1[11] += data[i].NoticeCount;
                           }
                       }
                   }
               }
               option6.xAxis[0].data = option6datax;
               option6.series[0].data = option6data0;
               option6.series[1].data = option6data1;
           }
       });

       //危险源个数
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_HazardResourcesyymm", KeyWordType: "ViewEntity",
               select: "RegDate,EpsProjId,ResourcesCount",
               swhere: swherevalue + "='" + year + "' and EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option7datax = [];
               for (var y = 0; y < 9; y++) {
                   option7datax.push(year + "-0" + (1 + y));
               }
               for (var y1 = 9; y1 < 12; y1++) {
                   option7datax.push(year + "-" + (1 + y1));
               }
               var option7data0 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
               if (data.length > 0) {
                   for (var i = 0; i < data.length; i++) {
                       if (data[i].RegDate == option7datax[0]) {
                           option7data0[0] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[1]) {
                           option7data0[1] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[2]) {
                           option7data0[2] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[3]) {
                           option7data0[3] += data[i].ResourcesCount;
                       } else if (data[i].InspectionDate == option7datax[4]) {
                           option7data0[4] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[5]) {
                           option7data0[5] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[6]) {
                           option7data0[6] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[7]) {
                           option7data0[7] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[8]) {
                           option7data0[8] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[9]) {
                           option7data0[9] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[10]) {
                           option7data0[10] += data[i].ResourcesCount;
                       } else if (data[i].RegDate == option7datax[11]) {
                           option7data0[11] += data[i].ResourcesCount;
                       }
                   }
               }
               option7.xAxis[0].data = option7datax;
               option7.series[0].data = option7data0;
           }
       });

       //危险源类型
       $.ajax({
           url: "/Form/GridPageLoad",
           data: {
               KeyWord: "V_PS_HazardResourcesAccidentType", KeyWordType: "ViewEntity",
               select: "AccidentType,EpsProjId,ResourcesCount,RegDate",
               swhere: swherevalue + "='" + year + "' and EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
               sort: "",
               index: "",
               size: ""
           },
           type: "POST",
           cache: false,
           async: false,
           success: function (text) {
               //返回json字符串，需要先格式化成json包，再取数据
               var o = mini.decode(text);
               var data = mini.decode(o.data.value);
               if (!o.success) {
                   Power.ui.error(o.message, { detail: o.detail });
                   return false;
               }
               var option8data = [
                       { value: 0, name: '人身伤害' },
                       { value: 0, name: '机械损伤' },
                       { value: 0, name: '严重质量事故' }
               ];
               if (data.length > 0) {
                   for (var i = 0; i < data.length; i++) {
                       if (data[i].AccidentType == "A1") {
                           option8data[0].value += data[i].ResourcesCount;
                       } else if (data[i].AccidentType == "A2") {
                           option8data[1].value += data[i].ResourcesCount;
                       } else if (data[i].AccidentType == "A3") {
                           option8data[2].value += data[i].ResourcesCount;
                       } 
                   }
               }
               option8.series[0].data = option8data;
           }
       });

       //渲染图表
       function InitEChart(chartid, option) {

           require.config({
               paths: {
                   echarts: '/Scripts/plugins/echarts/'
               }
           });
           require([
               'echarts',
               'echarts/theme/default',
               'echarts/chart/line',   // 按需加载所需图表，如需动态类型切换功能  ，别忘了同时加载相应图表
               'echarts/chart/bar',
               'echarts/chart/pie',
               'echarts/chart/gauge'

           ], function (ec) {
               var myChart = ec.init(document.getElementById(chartid));
               $(window).resize(function () {
                   myChart.resize();
               });
               myChart.setOption(option);
               myChart.on("click", function (param) {
                   if (chartid == "chart5") {
                       if (typeof param.seriesIndex != 'undefined') {
                           window.open(
                               '/Form/EditForm/730b54ed-6405-410d-8c61-c86d479c521b/', '_self'
                           );
                       }
                   }

               })

           })
       }

       $(function () {
           InitEChart("chart1", option1);
           InitEChart("chart2", option2);
           InitEChart("chart3", option3);
           InitEChart("chart5", option5);
           InitEChart("chart6", option6);
           InitEChart("chart7", option7);
           InitEChart("chart8", option8);

       });
       mini.parse();
       $("#tabList li").on("click", function () {
           var $this = $(this);
           $this.addClass("active").siblings().removeClass("active");
           if ($this.text() == "金额") {

               $.ajax({
                   url: "/Form/GridPageLoad",
                   data: {
                       KeyWord: "V_PS_PreMProjectCategory", KeyWordType: "ViewEntity",
                       select: "TypeCount,ProjectCategory,EpsProjId,TotalInvestment",
                       swhere: "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
                       sort: "",
                       index: "",
                       size: ""
                   },
                   type: "POST",
                   cache: false,
                   async: false,
                   success: function (text) {
                       //返回json字符串，需要先格式化成json包，再取数据
                       var o = mini.decode(text);
                       var data = mini.decode(o.data.value);
                       if (!o.success) {
                           Power.ui.error(o.message, { detail: o.detail });
                           return false;
                       }
                       var option2data = [
                           { value: 0, name: '安全环保' },
                           { value: 0, name: '技术改造' },
                           { value: 0, name: '新建' },
                           { value: 0, name: '改建' },
                           { value: 0, name: '信息化' },
                           { value: 0, name: '技改' },
                           { value: 0, name: '其他' }
                       ]
                       for (var i = 0; i < data.length; i++) {
                           if (data[i].ProjectCategory == "安全环保") {
                               option2data[0].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           } else if (data[i].ProjectCategory == "技术改造") {
                               option2data[1].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           } else if (data[i].ProjectCategory == "新建") {
                               option2data[2].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           } else if (data[i].ProjectCategory == "改建") {
                               option2data[3].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           } else if (data[i].ProjectCategory == "信息化") {
                               option2data[4].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           } else if (data[i].ProjectCategory == "技改") {
                               option2data[5].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           } else if (data[i].ProjectCategory == "其他") {
                               option2data[6].value = parseFloat(data[i].TotalInvestment).toFixed(2);
                           }
                       }
                       option2.series[0].data = option2data;
                       InitEChart("chart2", option2);
                   }
               });
           } else if ($this.text() == "数量") {
               $.ajax({
                   url: "/Form/GridPageLoad",
                   data: {
                       KeyWord: "V_PS_PreMProjectCategory", KeyWordType: "ViewEntity",
                       select: "TypeCount,ProjectCategory,EpsProjId,TotalInvestment",
                       swhere: "EpsProjId in (select project_guid from PLN_project where LongCode like '" + LongCode + ".%' or LongCode='" + LongCode + "')",
                       sort: "",
                       index: "",
                       size: ""
                   },
                   type: "POST",
                   cache: false,
                   async: false,
                   success: function (text) {
                       //返回json字符串，需要先格式化成json包，再取数据
                       var o = mini.decode(text);
                       var data = mini.decode(o.data.value);
                       if (!o.success) {
                           Power.ui.error(o.message, { detail: o.detail });
                           return false;
                       }
                       var option2data = [
                           { value: 0, name: '安全环保' },
                           { value: 0, name: '技术改造' },
                           { value: 0, name: '新建' },
                           { value: 0, name: '改建' },
                           { value: 0, name: '信息化' },
                           { value: 0, name: '技改' },
                           { value: 0, name: '其他' }
                       ]
                       for (var i = 0; i < data.length; i++) {
                           if (data[i].ProjectCategory == "安全环保") {
                               option2data[0].value = data[i].TypeCount;
                           } else if (data[i].ProjectCategory == "技术改造") {
                               option2data[1].value = data[i].TypeCount;
                           } else if (data[i].ProjectCategory == "新建") {
                               option2data[2].value = data[i].TypeCount;
                           } else if (data[i].ProjectCategory == "改建") {
                               option2data[3].value = data[i].TypeCount;
                           } else if (data[i].ProjectCategory == "信息化") {
                               option2data[4].value = data[i].TypeCount;
                           } else if (data[i].ProjectCategory == "技改") {
                               option2data[5].value = data[i].TypeCount;
                           } else if (data[i].ProjectCategory == "其他") {
                               option2data[6].value = data[i].TypeCount;
                           }
                       }
                       option2.series[0].data = option2data;
                       InitEChart("chart2", option2);
                   }
               });
           }
       });

       function ProjectClick(e) {
           var getdata =mini.get("PS_PreMProject").getSelected();
           var ProjCode = getdata.ProjCode;
           var ProjName = getdata.ProjName;
           var url = "/PowerPlat/FormXml/zh-CN/StdPortalManage/Win_PS_EnterpriseCenter_T2.html?_projCode=" + ProjCode + "&_projName=" + ProjName + "";
           window.open(url, '_self');
       }

       function FormProjectEvents(formid) {
           var url = "/Form/ValidForm/7ead3f85-4dea-4562-b7f8-479ee8fa433e/view/" + formid;
           mini.open({
               url: url,
               width: 900,
               height: 550
           });
       }
</script>
<script>
    //tabs
    var tab1Item = $("#tabs1 .tab-title li");
    var tab1Content = $("#tabs1 .tab-content .tab-item");
    tab1Item.on("click", function () {
        changeTabs(this, tab1Item, tab1Content)
    })


    function changeTabs(item, items, tabContent) {

        var index = $(item).index();

        if ($(item).hasClass("this")) return;

        items.removeClass("this");

        $(items[index]).addClass("this");

        tabContent.removeClass("show");

        $(tabContent[index]).addClass("show");
    }

    function scrollTop(id) {
        var margintop = 0;//上边距的偏移量
        var stop = false;
        setInterval(function () {
            if (stop == true) {
                return;
            }
            if ($(id).children("li").length < 6) {
                stop = true;
                return;
            }
            $(id).children("li").first().animate({ "margin-top": margintop-- }, 0, function () {
                var $li = $(this);
                if (!$li.is(":animated")) {//第一个li的动画结束时
                    if (-margintop > $li.height()) {
                        $li.css("margin-top", "0px").appendTo($(id));
                        margintop = 0;
                    }
                }
            });
        }, 40);

        $(id).hover(function () {
            $(this).css("cursor", "pointer");
            stop = true;//停止动画
        }, function () {
            stop = false;//开始动画
        });
    }
    scrollTop("#planBox");
</script>