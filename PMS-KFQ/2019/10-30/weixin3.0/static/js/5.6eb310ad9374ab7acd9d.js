webpackJsonp([5],{"/EI9":function(t,i){},"1LAZ":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("tFWz"),s=e("F4+m"),l=e("Mlu6"),o=e("gyMJ"),c={mixins:[s.a],props:{loadStart:{type:Boolean,default:!1},KeyWord:{type:String,default:""},KeyValue:{type:String,default:""}},data:function(){return{picFileAttach:[],officeFileAttach:[],mediaFileAttach:[],otherFileAttach:[],fileLink:"",offset:100,configInit:!1,imgLocalIdArray:[],imgServerIdArray:[],upStatusWX:!1,upStatus:!1,toastMsg:"",text:"",text1:"",mx_isLoading:!1,mx_message:"",mx_alertShow:!1,mx_alertTitle:"提示",mx_toastShow:!1,mx_deleyTime:1e3}},created:function(){this.host=Object(l.q)("production"),this.wx=this.$wechat},mounted:function(){},methods:{previewFile:function(t){var i=location.origin+"/PowerPlat/Control/File.ashx?action=browser&_type=ftp&_fileid="+t.Id,e=t.FileSize?parseInt(t.FileSize):1048576;try{this.wx.previewFile({url:i,name:t.Name||"",size:e})}catch(t){window.open(i)}},previewImage:function(t){var i=location.origin,e="/PowerPlat/Control/File.ashx?action=browser&_type=ftp&_fileid=",a=[],s=i+e+t.Id;this.picFileAttach.map(function(t){var s=i+e+t.Id;a.push(s)}),this.wx.previewImage({current:s,urls:a})},getConfig:function(){var t=this,i=location.href.split("#")[0];Object(o.m)(i).then(function(i){var e=i.data,a=e.data;e.success?(a.jsApiList=a.jsApiList.concat(["previewFile"]),t.wx.config(a),t.configInit=!0):t.configInit=!1})},upLoad:function(){var t=this;this.addImageFile(function(){t.upLoadFileWX()})},addImageFile:function(t){if(this.upStatus=!1,this.upStatusWX=!1,!this.configInit)return this.MixinAlertShowEvent("微信配置初始化失败，请刷新重试"),!1;var i=this;this.wx.chooseImage({sourceType:["album","camera"],sizeType:["compressed"],success:function(e){i.imgLocalIdArray=e.localIds.concat(),t&&t()}})},upLoadFileWX:function(){var t=this;if(this.imgLocalIdArray.length>0){var i=this.imgLocalIdArray.shift();this.wx.uploadImage({localId:i,isShowProgressTips:1,success:function(i){t.imgServerIdArray.push(i.serverId),0===t.imgLocalIdArray.length?t.upLoadFile():t.upLoadFileWX()}})}},upLoadFile:function(){var t=this,i={imgServerIds:this.imgServerIdArray.concat().join(","),KeyValue:this.KeyValue,KeyWord:this.KeyWord};this.MinXinHttpFetch(Object(o.b)(i),function(i){t.imgServerIdArray=[],i.success&&(t.toastMsg="上传成功",t.mx_toastShow=!0,t.GetDocFilesLoad(t.KeyWord,t.KeyValue))})},closeFile:function(){var t=this;this.offset=100,this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.fileLink=""},400)},showFile:function(t){this.fileLink=this.host+"/PowerPlat/FormXml/FileViewer.aspx?online=1&fileid="+t.Id,this.offset=0},GetDocFilesLoad:function(t,i){var e=this,a={KeyWord:t,KeyValue:i,index:"0",size:"0",sort:"",select:"",swhere:""};this.MinXinHttpFetch(Object(o.l)(a),function(t){var i=t.data.value,a=[];""!==i&&(a=JSON.parse(i)),e.checkFileKinds(a)})},getFileData:function(t,i){this.getConfig(),this.GetDocFilesLoad(t,i)},checkFileKinds:function(t){for(var i=/\.(png|jpe?g|gif|svg)(\?.*)?$/,e=/\.(mp4|webm|ogg|mp3|wav|flac|aac)(\?.*)?$/,a=/\.(doc|docx|docm|dot|dotx|dotm|pdf|xls|xlsx|xlsm|xlt|xltx|xltm|csv|ppt|pptx|pptm|pot|potx|potm|pps|ppsx|ppsm)(\?.*)?$/,s=[],l=[],o=[],c=[],n=0;n<t.length;n++){var r=t[n];i.test(r.FileExt)?s.push(r):e.test(r.FileExt)?l.push(r):a.test(r.FileExt)?o.push(r):c.push(r)}this.picFileAttach=s,this.mediaFileAttach=l,this.officeFileAttach=o,this.otherFileAttach=c}},components:{AttachList:a.a}},n={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"file-attach"},[e("div",{staticClass:"file-attach-inner"},[e("form",{staticClass:"file-attach-content"},[t.picFileAttach.length>0?e("div",{staticClass:"file-attach-type"},[e("h1",{staticClass:"type-title"},[t._v("图片")]),t._v(" "),e("ul",{staticClass:"file-attach-lists"},t._l(t.picFileAttach,function(i){return e("li",{key:i.Id,staticClass:"file-attach-list",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.previewImage(i)}}},[e("attach-list",{attrs:{attachList:i}})],1)}))]):t._e(),t._v(" "),t.mediaFileAttach.length>0?e("div",{staticClass:"file-attach-type"},[e("h1",{staticClass:"type-title"},[t._v("视频")]),t._v(" "),e("ul",{staticClass:"file-attach-lists"},t._l(t.mediaFileAttach,function(i){return e("li",{key:i.Id,staticClass:"file-attach-list",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.showFile(i)}}},[e("attach-list",{attrs:{attachList:i}})],1)}))]):t._e(),t._v(" "),t.officeFileAttach.length>0?e("div",{staticClass:"file-attach-type"},[e("h1",{staticClass:"type-title"},[t._v("文档")]),t._v(" "),e("ul",{staticClass:"file-attach-lists"},t._l(t.officeFileAttach,function(i){return e("li",{key:i.Id,staticClass:"file-attach-list",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.showFile(i)}}},[e("attach-list",{attrs:{attachList:i}})],1)}))]):t._e(),t._v(" "),t.otherFileAttach.length>0?e("div",{staticClass:"file-attach-type"},[e("h1",{staticClass:"type-title"},[t._v("其他")]),t._v(" "),e("ul",{staticClass:"file-attach-lists"},t._l(t.otherFileAttach,function(i){return e("li",{key:i.Id,staticClass:"file-attach-list",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.showFile(i)}}},[e("attach-list",{attrs:{attachList:i}})],1)}))]):t._e()]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:100===t.offset,expression:"offset === 100"}],staticClass:"attach-action",on:{click:t.upLoad}},[e("svg",{staticClass:"vux-x-icon vux-x-icon-ios-plus-empty",attrs:{type:"ios-plus-empty",size:"40",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 512 512"}},[e("path",{attrs:{d:"M384 265H264v119h-17V265H128v-17h119V128h17v120h120v17z"}})])])]),t._v(" "),e("div",{staticClass:"iframe-wrap",style:{transform:"translate3d("+this.offset+"%, 0, 0)"}},[e("iframe",{staticClass:"iframe",attrs:{src:t.fileLink,frameborder:"0"}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.offset<=100,expression:"offset <= 100"}],staticClass:"back-wrap",on:{click:t.closeFile}},[e("span",{staticClass:"fa fa-reply"})])]),t._v(" "),e("loading",{model:{value:t.mx_isLoading,callback:function(i){t.mx_isLoading=i},expression:"mx_isLoading"}}),t._v(" "),e("toast",{attrs:{type:"text",time:t.mx_deleyTime},model:{value:t.mx_toastShow,callback:function(i){t.mx_toastShow=i},expression:"mx_toastShow"}},[t._v(t._s(t.toastMsg))]),t._v(" "),e("alert",{attrs:{title:t.mx_alertTitle,content:t.mx_message},on:{"on-hide":t.MixinAlertHideEvent},model:{value:t.mx_alertShow,callback:function(i){t.mx_alertShow=i},expression:"mx_alertShow"}})],1)},staticRenderFns:[]};var r=e("C7Lr")(c,n,!1,function(t){e("/EI9")},"data-v-ba29de5e",null);i.default=r.exports},JK5U:function(t,i){},tFWz:function(t,i,e){"use strict";var a=e("Mlu6"),s={mixins:[e("F4+m").a],props:{attachList:{type:Object,default:function(){return{UpdHumName:"附件测试",avatar:"./fileVideo.png",Name:"fileVideo.png",id:""}}},isEdit:{type:Boolean,default:!1}},created:function(){this.host=Object(a.q)("production")},methods:{deleteFile:function(t){this.$emit("deleteFile",t)},_formatDate:function(t){return Object(a.f)(t)},getFileIconLink:function(t){return Object(a.l)(t)}}},l={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"attach-list"},[e("div",{staticClass:"list-unit avatar-box"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.getFileIconLink(t.attachList),expression:"getFileIconLink(attachList)"}],attrs:{alt:""}})]),t._v(" "),e("div",{staticClass:"list-unit title-box"},[e("p",{staticClass:"list-title list-unit-date"},[e("span",[t._v(t._s(this._formatDate(t.attachList.UpdDate)))]),t._v(" "),e("span",{staticClass:"up-load-HuName"},[t._v("上传人: "+t._s(t.attachList.UpdHumName))])]),t._v(" "),e("p",{staticClass:"list-title list-unit-title"},[t._v(t._s(t.attachList.Name)+t._s(t.attachList.FileExt))])]),t._v(" "),t.isEdit?e("div",{staticClass:"list-unit delete-box"},[e("div",{staticClass:"close-icon",on:{click:function(i){i.stopPropagation(),i.preventDefault(),t.deleteFile(t.attachList)}}},[e("svg",{staticClass:"vux-x-icon vux-x-icon-ios-close-empty",attrs:{type:"ios-close-empty",size:"30",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 512 512"}},[e("path",{staticClass:"st0",attrs:{d:"M340.2 160l-84.4 84.3-84-83.9-11.8 11.8 84 83.8-84 83.9 11.8 11.7 84-83.8 84.4 84.2 11.8-11.7-84.4-84.3 84.4-84.2z"}})])])]):t._e()])},staticRenderFns:[]};var o=e("C7Lr")(s,l,!1,function(t){e("JK5U")},"data-v-368ff430",null);i.a=o.exports}});
//# sourceMappingURL=5.6eb310ad9374ab7acd9d.js.map