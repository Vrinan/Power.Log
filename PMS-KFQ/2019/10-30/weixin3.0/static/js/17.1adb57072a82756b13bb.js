webpackJsonp([17],{s7Yo:function(t,e){},yuvn:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("aA9S"),s=a.n(i),o=a("4YfN"),l=a.n(o),r=a("9rMa"),n=a("bGai"),c=a("Mlu6"),h=a("F4+m"),m=a("gyMJ"),d={mixins:[h.a],props:{KeyValue:{type:String,default:""},comboboxdata:{type:Object,default:function(){return{}}},formAllConfig:{type:Object,default:function(){return{}}},chileTableItem:{type:Object,default:function(){return{}}},tableData:{type:Object,default:function(){return{}}},mainformData:{type:Object,default:function(){return{}}}},computed:l()({isEdit:function(){var t=this.routerParams.formstate;switch(this.formStatusValue){case"40":case"50":return!1;default:return"view"!==t}}},Object(r.c)(["routerParams","formStatusValue"])),data:function(){return{KeyWord:"",formState:"",showCheckBox:!1,tagShow:!1,offset:100,tableLists:[],defaultData:[],selectItems:[],currentItem:{},tableShowField:[],option:{title:{text:"",show:!0},left:{text:"",show:!0},center:{text:"",show:!0},right:{text:"",show:!0}},subTableData:[],subTableTextNameOption:{},subTableShowField:[],tableType:"",selectId:"",mx_isLoading:!1,mx_message:"",mx_alertShow:!1,mx_alertTitle:"提示",mx_toastShow:!1,mx_toastText:"",mx_deleyTime:1e3}},mounted:function(){this.formState=this.routerParams.formstate,this.tableInit()},methods:{tableInit:function(){var t=this.chileTableItem.textNameOption,e=this.chileTableItem.tableListType,a=this.chileTableItem.subTable;this.tableShowField=this.chileTableItem.tableShowField,this.option=s()(this.option,t),this.KeyWord=this.chileTableItem.KeyWord,this.tableType=Object(c.p)(e),a&&"withCommonTable"===a&&(this.subTableTextNameOption=this.chileTableItem.subTableTextNameOption,this.subTableShowField=this.chileTableItem.subTableShowField)},formRowChange:function(t){this.currentItem[t.field]=t.value},_add:function(){var t=this.chileTableItem.addType,e=this.routerParams.formstate;"fromWizard"===t?this.MixinAlertShowEvent("仅限查看,不能新增"):"view"===e?this.MixinAlertShowEvent("仅限查看,不能新增"):"add"===e?this.MixinAlertShowEvent("目前处于新增状态,请保存主表"):(this.addFormLoad(),this.offset=0)},saveFromData:function(){var t=this,e="auto",a=this.chileTableItem.data.foreignfield,i=this.chileTableItem.KeyWordType;if(Object(c.a)(a,this.currentItem)){if(e="add","0000"===this.KeyValue)return this.MixinAlertShowEvent("需先保存主表"),!1;this.currentItem=Object(c.y)(a,this.currentItem,this.mainformData,!0)}else e="edit";var s={KeyWord:this.KeyWord,formAllConfig:this.formAllConfig,KeyWordType:i,data:[this.currentItem],formDate:e,FormId:this.routerParams.FromId},o=Object(c.s)(s);this.MinXinHttpFetch(Object(m.j)(o),function(e){e.success?(t.mx_toastText="保存成功",t.mx_toastShow=!0,t.$emit("saveChildFrom"),t.closeEditBlock()):t.currentItem=Object(c.y)(a,t.currentItem,t.mainformData,!1)})},deleteSelectedItems:function(){var t=this,e={KeyWord:this.KeyWord,formAllConfig:this.formAllConfig,KeyWordType:"BO",data:this.selectItems,formDate:"delete",FormId:this.routerParams.FromId},a=Object(c.s)(e);this.MinXinHttpFetch(Object(m.j)(a),function(e){e.success&&(t.mx_toastText="删除成功",t.mx_toastShow=!0,t.$emit("saveChildFrom"),t._backPre())})},addFormLoad:function(){var t=this,e={KeyWord:this.KeyWord,KeyValue:"",KeyWordType:"BO",swhere:"",select:"",formstate:"add"};this.MinXinHttpFetch(Object(m.i)(e),function(e){var a=e.data.value;t.currentItem=JSON.parse(a)})},selectItemView:function(t){if(this.showCheckBox)return!1;this.currentItem=Object(c.i)(this.comboboxdata,t,this.KeyWord),this.offset=0;var e=this.chileTableItem.subTable;"withAttach"===e&&this.$refs.subFileAttach.GetDocFilesLoad(this.KeyWord,this.currentItem.Id),"withCommonTable"===e&&(this.selectId=t.Code)},_backPre:function(){var t=this.$refs.formListUnit;t&&0!==t.length&&t.forEach(function(t){t.backDefault()}),this.showCheckBox=!1,this.selectItems=[]},_delete:function(){var t=this.chileTableItem.addType,e=this.routerParams.formstate;"fromWizard"===t?this.MixinAlertShowEvent("仅限查看,不能删除"):"view"===e?this.MixinAlertShowEvent("仅限查看,不能删除"):"add"===e?this.MixinAlertShowEvent("目前处于新增状态,请保存主表"):this.deleteSelectedItems()},_preDelete:function(){this.showCheckBox=!0},_selectItem:function(t){this.selectItems.push(t)},_unSelectItem:function(t){Object(c.v)(this.selectItems,t)},closeEditBlock:function(){this.offset=100}},watch:{tableData:{handler:function(t,e){t.values||(t.values=[]),"withCommonTable"===this.chileTableItem.subTable&&(this.subTableData=s()({},t)),this.tableLists=t.values.concat()},immediate:!0}},components:{SearchBox:n.m,FormList:n.f,FooterBar:n.d,FormRow:n.g,subFileAttach:n.s,SubCommonTable:n.n}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chile-table-unit"},[a("div",{staticClass:"child-main-content"},[a("form",{staticClass:"child-main-table"},[a("ul",{staticClass:"child-table-lists"},["table"===t.tableType?a("li",{staticClass:"table-title"},[a("div",{staticClass:"title-wrap"},[t.option.title.show?a("div",{staticClass:"title-item"},[a("span",{staticClass:"text"},[t._v(t._s(t.option.title.text))])]):t._e(),t._v(" "),t.option.left.show?a("div",{staticClass:"title-item"},[a("span",{staticClass:"text"},[t._v(t._s(t.option.left.text))])]):t._e(),t._v(" "),t.option.center.show?a("div",{staticClass:"title-item"},[a("span",{staticClass:"text"},[t._v(t._s(t.option.center.text))])]):t._e(),t._v(" "),t.option.right.show?a("div",{staticClass:"title-item"},[a("span",{staticClass:"text"},[t._v(t._s(t.option.right.text))])]):t._e()])]):t._e(),t._v(" "),t._l(t.tableLists,function(e){return t.tableLists.length?a("li",{key:e.Id,staticClass:"table-list",on:{click:function(a){t.selectItemView(e)}}},[a("form-list",{ref:"formListUnit",refInFor:!0,attrs:{item:e,showCheckBox:t.showCheckBox,tagShow:t.tagShow,option:t.option,tableType:t.tableType,KeyWord:t.KeyWord,comboboxdata:t.comboboxdata},on:{selectItem:t._selectItem,unSelectItem:t._unSelectItem}})],1):t._e()})],2)]),t._v(" "),t.isEdit?a("footer-bar",{on:{Add:t._add,preDelete:t._preDelete,Delete:t._delete,backPre:t._backPre}}):t._e()],1),t._v(" "),a("div",{staticClass:"chile-table-lists-form",style:{transform:"translate3d("+this.offset+"%, 0, 0)"}},[a("form",{staticClass:"input-textarea-group"},[t._l(t.tableShowField,function(e,i){return t.tableShowField.length>0?a("form-row",{key:i,attrs:{label:e.title,type:e.format,readonly:e.readonly,required:e.required,disabled:e.disabled,placeholder:e.placeholder,field:e.field,KeyWord:t.KeyWord,mainformData:t.currentItem,comboboxdata:t.comboboxdata},on:{enterChange:t.formRowChange}}):t._e()}),t._v(" "),"withAttach"===t.chileTableItem.subTable?a("div",{staticClass:"sub-file-attach-warp"},[a("h1",{staticClass:"sub-file-attach-title font-color-active"},[t._v("附件列表:")]),t._v(" "),a("sub-file-attach",{ref:"subFileAttach",attrs:{KeyWord:t.KeyWord,KeyValue:t.currentItem.Id}})],1):t._e(),t._v(" "),"withCommonTable"===t.chileTableItem.subTable?a("div",{staticClass:"sub-file-attach-warp"},[a("h1",{staticClass:"sub-file-attach-title font-color-active"},[t._v("请购明细:")]),t._v(" "),a("sub-common-table",{attrs:{tableTextNameOption:t.subTableTextNameOption,tableShowField:t.subTableShowField,tableData:t.subTableData,tableType:t.tableType,comboboxdata:t.comboboxdata,selectId:t.selectId}})],1):t._e()],2),t._v(" "),a("div",{staticClass:"footer-actions"},[t.isEdit?a("div",{staticClass:"action-item",on:{click:t.saveFromData}},[t._v("保存")]):t._e(),t._v(" "),a("div",{staticClass:"action-item",on:{click:t.closeEditBlock}},[t._v("关闭")])])]),t._v(" "),a("loading",{model:{value:t.mx_isLoading,callback:function(e){t.mx_isLoading=e},expression:"mx_isLoading"}}),t._v(" "),a("toast",{attrs:{type:"text",time:t.mx_deleyTime},model:{value:t.mx_toastShow,callback:function(e){t.mx_toastShow=e},expression:"mx_toastShow"}},[t._v(t._s(t.mx_toastText))]),t._v(" "),a("alert",{attrs:{title:t.mx_alertTitle,content:t.mx_message},on:{"on-hide":t.MixinAlertHideEvent},model:{value:t.mx_alertShow,callback:function(e){t.mx_alertShow=e},expression:"mx_alertShow"}})],1)},staticRenderFns:[]};var u=a("C7Lr")(d,b,!1,function(t){a("s7Yo")},"data-v-5e9bbc7e",null);e.default=u.exports}});
//# sourceMappingURL=17.1adb57072a82756b13bb.js.map