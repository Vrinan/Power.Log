
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <script src="/Scripts/boot.js?v=77" type="text/javascript"></script>
    <script src="/Scripts/PlatForm/ComTools.js?v=77" type="text/javascript"></script>
    <script src="/Scripts/PlatForm/WebForm.js?v=77" type="text/javascript"></script>
    <!--<script src="/PowerPlat/WorkFlow/js/FlowStatusSeries.js?v=77" type="text/javascript"></script>
    <script src="/Scripts/PlatForm/WorkFlowForm.js?v=77" type="text/javascript"></script>-->
    <script src="/Form/Init/$Model.data.FormId/$Model.data.FormState/$Model.data.KeyValue"></script>
    <script language="javascript" src="/Scripts/PlatForm/ControlCenter.js?v=77 "></script>
    <script language="javascript" src="/Scripts/PlatForm/WorkFlowsEnums.js?v=77 "></script>
    <script language="javascript" src="/Scripts/PlatForm/WorkFlowsForm.js?v=77 "></script>
    <script type="text/javascript" hasvelocity="true">
        var KeyValue = "";
        var FormId = "bfe2c5d3-d71f-498d-ac13-77ef50aa8e4d";
        var FormState = "add";
        var currentproj = "00000000-0000-0000-0000-0000000000a4";
    </script>
</head>
<body>
    <div class="row" style="height: 100%">
        <div class="portlet box blue" style="height: 100%">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-reorder"></i>投标文件编制记录
                </div>
                <!--基础数据定义-->
                <div style="float: left;">
    &nbsp;&nbsp;
    <div id="txtCurrentWorkInfoID" class="mini-textbox" style="display: none"></div>
    <div id="txtCurrentSequeID" class="mini-textbox" enabled="false" style="display: none"></div>
    <div id="btnActive" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,Active');" enabled="false" style="display: none" visible="false"><i class="fa fa-paper-plane"></i>送审</div><!--送审-->
    <div id="btnGetBack" class="mini-button flowbuttoncolor" onclick="onExecute(this,'GetBack');" enabled="false" style="display: none" visible="false"><i class="fa fa-trash-o"></i>回收</div><!--回收-->
    <div id="btnSend" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,Send');" enabled="false" style="display: none" visible="false"><i class="fa fa-thumbs-up"></i>审批</div><!--同意-->
    <div id="btnBatchSends" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,BatchSends');" enabled="false" style="display: none" visible="false"><i class="fa fa-thumbs-up"></i>批量同意</div><!--批量同意-->
    <div id="btnReturn" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,Return');" enabled="false" style="display: none" visible="false"><i class="fa fa-mail-reply"></i>驳回</div><!--驳回-->
    <div id="btnStop" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,Stop');" enabled="false" style="display: none" visible="false"><i class="fa fa-pause"></i>终止</div><!--终止-->
    <div id="btnScrap" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,Scrap');" enabled="false" style="display: none" visible="false"><i class="fa fa-pause"></i>作废</div><!--作废-->
    <div id="btnDelegate" class="mini-button flowbuttoncolor" enabled="false" onclick="onExecute(this,'Delegate');" style="display: none" visible="false"><i class="fa fa-graduation-cap"></i>委派</div><!--委派-->
    <div id="btnShowMonitor" class="mini-button flowbuttoncolor" enabled="false" style="display: none" visible="false"><i class="fa fa-eye"></i>监控</div><!--old监控-->
    <div id="btnShowMonitorVIS" class="mini-button flowbuttoncolor" enabled="false" style="display: none" visible="false"><i class="fa fa-eye"></i>监控 </div><!--监控-->
    <div id="btnShowHistoryMonitor" class="mini-menubutton  flowbuttoncolor" menu="#popupHistoryMonitor" enabled="false" style="display: none" visible="false"><i class="fa fa-eye"></i>审批历史</div><!--历史-->
    <div id="btnHangUp" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,HangUp');" enabled="false" style="display: none" visible="false"><i class="fa fa-arrow-up"></i>挂起</div><!--挂起-->
    <div id="btnUnHangUp" class="mini-button flowbuttoncolor" onclick="onExecute(this,'UnHangUp');" enabled="false" style="display: none" visible="false"><i class="fa fa-arrow-down"></i>撤销挂起</div><!--撤销挂起-->
    <div id="btnDelayDate" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Update,DelayDate');" enabled="false" style="display: none" visible="false"><i class="fa fa-calendar"></i></div><!--延期-->
    <div id="btnUnEndFlow" class="mini-button flowbuttoncolor" onclick="onExecute(this,'UnEndFlow');" enabled="false" style="display: none" visible="false"><i class="fa fa-trash-o"></i></div><!--撤销办结-->
 <div id="btnForward" class="mini-button flowbuttoncolor" onclick="onExecute(this,'Forward');" enabled="false" style="display: none" visible="false" title="历史经手人，打开已结束的单据，还能添加人员做额外的抄送"><i class="fa fa-arrow-down"></i>转发</div>
   
       <div id="btnExportRecord" class="mini-button flowbuttoncolor" onclick="PowerWorkFlowUtil.TransRecord('ExportInstance');" style="display:none" visible="false" enabled="false"    ><i class="fa fa-trash-o"></i>导出</div><!--导出记录-->
       <div id="btnImportRecord" class="mini-button flowbuttoncolor" onclick="PowerWorkFlowUtil.TransRecord('ImportInstance');"   style="display:none" visible="false" enabled="false"   ><i class="fa fa-trash-o"></i>导入</div><!--导入记录-->

</div>
<ul id="popupHistoryMonitor" class="mini-menu" style="display: none;">
    <li></li>
</ul>


<style type="text/css">
    .mini-button.flowbuttoncolor {        
          border-radius:6px;            /* W3C syntax */
        background-color: rgb(67, 108, 241);
        color: white;
    }

    .flowbuttoncolor i {
        color: #fff;
    }

</style> 

                <div class="actions">
                    <div class="btn-group">
                        <!--<a class="mini-button blue" id="btnActive" onclick="WorkFlowUtils.ActiveWorkFlow(this)" style="display:none"><i class="fa fa-save"></i>送审</a>-->
                        <a class="mini-button blue" id="SF_RecruitmentDocumentsPlan.Save" onclick="PowerForm.OnBtnSave(this)"><i class="fa fa-save"></i>保存</a><!--保存-->
                        <a class="mini-button blue" id="SF_RecruitmentDocumentsPlan.Refresh" onclick="PowerForm.OnBtnRefresh(this)"><i class="fa fa-refresh"></i>刷新</a><!--刷新-->
                        <a class="mini-button blue" id="SF_RecruitmentDocumentsPlan.CloseForm" onclick="PowerForm.OnBtnCloseForm(this)"><i class="fa fa-power-off"></i>关闭</a><!--关闭-->
                    </div>
                </div>
            </div>
            <div class="mini-fit">
                <div class="portlet-body" style="height: 100%;">
                    <div id="maintabs" class="mini-tabs" tabposition="left" tabalign="left" style="height: 100%;">
                        <div title='基本信息'>
                            <!--通常-->
                            <div id="SF_RecruitmentDocumentsPlan" class="form">
                                <table class="table table-bordered">
                                    <tr>
                                        <td>
                                            编号
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.Code" name="Code" class="mini-textbox" required="true" />
                                        </td>
                                        <td>
                                            状态
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.Status" name="Status" class="mini-combobox" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            标题
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.Title" name="Title" class="mini-textbox" required="true" />
                                        </td>
                                        <td>
                                                填报部门
                                        </td>
                                        <td>
                                                <input id="SF_RecruitmentDocumentsPlan.DeptName" class="mini-textbox" name="DeptName" readonly/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            项目编号
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.ProjCode" name="ProjCode" textname="ProjCode" class="mini-buttonedit" allowinput="false"
                                                   emptytext="请选择项目..." onbuttonclick="PowerForm.OnBtnWizard(this)" allowinput="true" />
                                        </td>
                                        <td>
                                            项目名称
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.ProjName" name="ProjName" class="mini-textbox" readonly />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            项目性质
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.ProjectType" name="ProjectType" class="mini-combobox" readonly />
                                        </td>
                                        <td>
                                            项目规模
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.ProjectSize" name="ProjectSize" class="mini-textbox" readonly />
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>
                                            备注
                                        </td>
                                        <td colspan="3">
                                            <input id="SF_RecruitmentDocumentsPlan.Memo" name="Memo" class="mini-textarea" height="100"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            录入人
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.RegHumName" name="RegHumName" class="mini-textbox" readonly="readonly" />
                                        </td>
                                        <td>
                                            录入时间
                                        </td>
                                        <td>
                                            <input id="SF_RecruitmentDocumentsPlan.RegDate" name="RegDate" class="mini-datepicker" readonly="readonly" />
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div title='计划明细'>
                            <!--数据明细-->
                            <div class="mini-toolbar">
                                <a class="mini-button blue" iconcls="fa-plus" id="SF_RecruitmentDocumentsPlan_dtl.Add" onclick="PowerForm.OnBtnAdd(this)">新增</a><!--新增-->
                                <a class="mini-button blue" iconcls="fa-trash-o" id="SF_RecruitmentDocumentsPlan_dtl.Delete" onclick="PowerForm.OnBtnDel(this)">删除</a><!--删除-->
                            </div>
                            <div class="mini-fit">
                                <div id="SF_RecruitmentDocumentsPlan_dtl" class="mini-datagrid" style="height: 100%;" multiselect="true"
                                     idfield="Id" allowresize="true" allowcelledit="true" allowcellselect="true">
                                    <div property="columns">
                                        <div type="indexcolumn"></div>
                                        <div type="checkcolumn"></div>
                                        <!--名称-->
                                        <div field="PlanBidType" headeralign="center" type="comboboxcolumn">
                                            标书分类
                                            <input property="editor" class="mini-combobox" style="width: 100%;" />
                                        </div>
                                        <div field="PlanName" headeralign="center">
                                            编写内容
                                            <input property="editor" class="mini-textbox" style="width: 100%;" />
                                        </div>
                                        <div field="RegDepart" headeralign="center">
                                            编制部门
                                            <input property="editor" id="SF_RecruitmentDocumentsPlan_dtl.RegDepart" class="mini-buttonedit" name="RegDepart" textname="RegDepart" onbuttonclick="PowerForm.OnBtnWizard(this)" allowinput="false" style="width: 100%;" />
                                        </div>
                                        <div field="PlanDate" headeralign="center" dateformat="yyyy-MM-dd">
                                            完成日期
                                            <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                        </div>
                                        <div header="一审" headerAlign="Center">
                                            <div property="columns">
                                                <div field="DutyHumName" headeralign="center">
                                                    审核人
                                                    <input property="editor" id="SF_RecruitmentDocumentsPlan_dtl.DutyHumName" class="mini-buttonedit" name="DutyHumName" textname="DutyHumName" onbuttonclick="PowerForm.OnBtnWizard(this)" allowinput="false" style="width: 100%;"   readonly/>
                                                </div>
                                               
                                                <div field="FinishDateA" headeralign="center" dateformat="yyyy-MM-dd">
                                                    完成时间
                                                    <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                                </div>
                                                <div field="ApprovalOne" headeralign="center" dateformat="yyyy-MM-dd">
                                                    实际时间
                                                    <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                                </div>
                                            </div>
                                        </div>
                                        <div header="二审" headerAlign="Center">
                                            <div property="columns">
                                                <div field="DutyHumNameA" headeralign="center">
                                                    审核人
                                                    <input property="editor" id="SF_RecruitmentDocumentsPlan_dtl.DutyHumNameA" class="mini-buttonedit" name="DutyHumNameA" textname="DutyHumNameA" onbuttonclick="PowerForm.OnBtnWizard(this)" allowinput="false" style="width: 100%;" readonly />
                                                </div>
                                               
                                                <div field="FinishDateB" headeralign="center" dateformat="yyyy-MM-dd">
                                                    完成时间
                                                    <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                                </div>
                                                <div field="ApprovalTwo" headeralign="center" dateformat="yyyy-MM-dd">
                                                    实际时间
                                                    <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                                </div>
                                            </div>
                                        </div>
                                        <div field="RequiredAskDate" headeralign="center" dateformat="yyyy-MM-dd">
                                            定稿时间
                                            <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                        </div>
                                        <div field="RequiredDate" headeralign="center" dateformat="yyyy-MM-dd">
                                            打印装订时间
                                            <input property="editor" class="mini-datepicker" style="width: 100%;" />
                                        </div>
                                        <div field="Memo" headeralign="center">
                                            备注
                                            <input property="editor" class="mini-textbox" style="width: 100%;" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div title="附件" name="attachfile" url=""></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        mini.parse();
        var PowerForm = new WebForm();
        $(function () {
            PowerForm.Init();
        });

        PowerForm.EventWizardAfterUpdateRow = function (sender, currow, btnid) {
            if (btnid == "SF_RecruitmentDocumentsPlan.ProjCode") {
                mini.get("SF_RecruitmentDocumentsPlan.Save").doClick();
            }
        }

        PowerForm.EventAfterFormLoad = function (e) {
            var mtabs = mini.get("maintabs");
            if (mtabs != undefined) {
                var mkeyword = "SF_RecruitmentDocumentsPlan";
                var mkeyvalue = formconfig.KeyValue;
                var tmptab = mtabs.getTab("attachfile");
                if (tmptab) {
                    var effected = formconfig.Effected;
                    var upddata = { url: "/Form/OpenURL?url=/PowerPlat/FormXml/zh-CN/FileOperate.htm&KeyWord=" + mkeyword + "&KeyValue=" + mkeyvalue };

                    //upddata.url += "&canEdit=false";//不允许编辑附件页面

                    upddata.url += "&canEdit=true";//允许编辑附件页面
                    mtabs.updateTab(tmptab, upddata);
                    mtabs.reloadTab(tmptab);
                }
            }
        }
        PowerForm.EventAfterLoadRight = function (e) {
            var mtabs = mini.get("maintabs");
            if (mtabs != undefined) {
                var mkeyword = "SF_RecruitmentDocumentsPlan";
                var mkeyvalue = formconfig.KeyValue;
                var tmptab = mtabs.getTab("attachfile");
                if (tmptab) {
                    var effected = formconfig.Effected;
                    var upddata = { url: "/Form/OpenURL?url=/PowerPlat/FormXml/zh-CN/FileOperate.htm&KeyWord=" + mkeyword + "&KeyValue=" + mkeyvalue };

                    //upddata.url += "&canEdit=false";//不允许编辑附件页面

                    upddata.url += "&canEdit=true";//允许编辑附件页面
                    mtabs.updateTab(tmptab, upddata);
                    mtabs.reloadTab(tmptab);
                }
            }
        }



        PowerForm.EventBeforeOnBtnFlow = function (e) {
            e.isValid = true;
            var HumanId = sessiondata.HumanId;
            if (workflowdata && workflowdata.BookMarkCode && workflowdata.BookMarkCode.toString().indexOf("bmfzr") > -1) {
                var Id = formconfig.config.joindata.currow.Id;
                $.ajax({
                    url: "/yxy/Matching",
                    type: "POST",
                    data: {
                        Id: Id,
                        HumanId: HumanId
                    },
                    cache: false,
                    async: false,
                    success: function (text) {
                        tmp = mini.decode(text);//数据集合
                        if (tmp == "1") {
                            e.isValid = true;
                        }
                        if (tmp == "0") {
                            e.isValid = false;
                            Power.ui.alert("请上传附件！");
                        }
                    }
                });
            }
        }

    </script>
</body>
</html>


