<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <script src="/Scripts/boot.js?v=$AppVersion" type="text/javascript"></script>
    <script src="/Scripts/PlatForm/ComTools.js?v=$AppVersion" type="text/javascript"></script>
    <script src="/Scripts/PlatForm/SingleForm.js?v=$AppVersion" type="text/javascript"></script>
    <script src="/Form/Init/$Model.data.FormId/$Model.data.FormState/$Model.data.KeyValue"></script>
    <script type="text/javascript" hasvelocity="true">
        var OpenFormId = "$Model.data.OpenFormId";
        var FormId = "$Model.data.FormId";
        var FormState = "$Model.data.FormState";
        var KeyValue = "$Model.data.KeyValue";
    </script>
</head>
<body>
    <div class="row-wrap">
        <div class="row  row-hd row-hd-responsive" style="height: 100%">
            <div class="col-md-12 col-hd-12">
                <div class="portlet blue box" style="height: 100%">
                    <div class="portlet-title">
                        <div class="captiontools">
                            <a class="mini-button blue" id="View_SF_HazardResources.Refresh" onclick="PowerForm.OnBtnRefresh(this)"><i class="fa fa-refresh"></i>刷新</a>
                            <!-- <div id="View_SF_HazardResources-Export" title="重要环境因素清单汇总" class="btn-group"></div> -->
                            <a class="mini-button green" iconcls="fa fa-sign-out" id="View_SF_HazardResources.Export" onclick="PowerForm.AlExport('View_SF_HazardResources', '重要环境因素清单汇总','Title,MainReason,MainDamage,MayDamage,MainDel')">导出</a>
                        </div>
                    </div>
                    <div class="portlet-body" style="height: 100%">
                        <div id="View_SF_HazardResources"  multiselect="true" class="mini-datagrid" style="width: 100%; height: 100%;" 
                            idField="Id" allowCellWrap="true" allowcelledit="true" allowcellselect="true" showpager="false" sortField="Title,MainReason,MainDamage,MayDamage,MainDel">
                            <div property="columns">
                                <!-- <div field="Code" name="Code" width="20">编号</div> -->
                                <div field="Title" name="Title" width="50">危险源(点)</div>
                                <div field="MainReason" name="MainReason" width="70">主要危险因素</div>
                                <div field="MainDamage" name="MainDamage" width="130">主要危害</div>
                                <div field="MayDamage" name="MayDamage" width="70">可能导致的事故</div>
                                <div field="MainDel" name="MainDel" width="280">主要控制措施</div>
                                <div field="Memo" name="Memo" width="60">备注</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        var PowerForm = new SingleForm();
        $(function () {
            PowerForm.Init();
        });
        mini.parse();
        mini.get("View_SF_HazardResources").on("load",function(e){
            // mini.get('View_SF_HazardResources').mergeColumns(["Title","MainReason","MainDamage","MayDamage","MainDel"]);
            mini.get('View_SF_HazardResources').mergeColumns(["Title"]);
        })
        mini.get("View_SF_HazardResources").on("drawcell",function(e){
            if(e.field=="MainDamage"||e.field=="MainDel"){
                e.cellHtml=e.cellHtml.replace(/\n/g,"</br>");
            }
        })
    </script>
</body>
</html>
